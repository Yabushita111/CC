{"ast":null,"code":"var _jsxFileName = \"/Users/yabu/board/src/components/mediaControls.jsx\";\nimport React from \"react\";\nimport styled from \"@emotion/styled\";\nimport KeyboardEventHandler from \"react-keyboard-event-handler\";\nimport { withRouter } from \"react-router\";\nimport { themes, breakpoints } from \"../theme\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst MediaControlsWrapper = styled(\"div\")`\n  display: ${({\n  hide\n}) => hide ? \"none\" : \"block\"};\n  margin-top: 1rem;\n  width: 100%;\n`;\n_c = MediaControlsWrapper;\nconst KeyboardShortcutsWrapper = styled(\"div\")({\n  position: \"relative\"\n});\nconst ShortcutsPane = styled(\"div\")`\n  position: absolute;\n  bottom: 2.5rem;\n  right: 2.5rem;\n  width: 20rem;\n  padding: 1rem;\n  border: solid 1px #999;\n  background: #fff;\n\n  @media (min-width: ${breakpoints.md}) {\n    left: 2.5rem;\n    right: 0;\n  }\n\n  h4 {\n    margin-top: 0;\n    margin-bottom: 1rem;\n  }\n\n  ul {\n    list-style-type: none;\n    margin: 0;\n    padding: 0;\n  }\n`;\n_c2 = ShortcutsPane;\nconst ButtonWrapper = styled(\"div\")({\n  display: \"flex\",\n  justifyContent: \"center\",\n  width: \"100%\"\n});\nconst Button = styled(\"button\")`\n  display: inline-block;\n  min-width: 3rem;\n  text-align: center;\n  background: transparent;\n  color: ${({\n  theme\n}) => theme === themes.dark ? \"#eee\" : \"#333\"};\n  font-size: 1.4rem;\n  border: none;\n  text-decoration: none;\n  cursor: pointer;\n  transition: background 250ms ease-in-out, transform 150ms ease;\n  -webkit-appearance: none;\n  -moz-appearance: none;\n\n  &:hover {\n    cursor: pointer;\n  }\n\n  &:focus {\n    outline: none;\n  }\n\n  &:disabled {\n    color: #ccc;\n    cursor: not-allowed;\n  }\n\n  @media (max-width: ${breakpoints.sm}) {\n    padding: 2rem 2rem;\n  }\n`;\n_c3 = Button;\nconst Scrubber = styled(\"input\")`\n  width: 100%;\n  max-width: 60rem;\n\n  &:disabled,\n  &:disabled:hover {\n    opacity: 0.2;\n    cursor: not-allowed;\n  }\n`;\n_c4 = Scrubber;\n\nclass MediaControls extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      paneHidden: true\n    };\n\n    this.handleParentKeyboardEvent = e => {\n      const {\n        code\n      } = e.data;\n      this.handleKeyEvent(this.keyboardCodeMap[code], e);\n    };\n\n    this.handleReload = () => {\n      this.props.reloadGame();\n    };\n\n    this.handlePlayPause = () => {\n      this.props.toggleGamePause();\n    };\n\n    this.handleBackward = () => {\n      this.props.stepBackwardFrame();\n    };\n\n    this.handleForward = () => {\n      this.props.stepForwardFrame();\n    };\n\n    this.handleScrubMouseDown = () => {\n      this.props.pauseGame();\n    };\n\n    this.handleScrubbing = event => {\n      this.props.stepToTurn(parseInt(event.target.value));\n    };\n\n    this.handleSettings = () => {\n      if (this.props.persistAvailable) {\n        this.props.history.push(\"/settings\");\n      }\n    };\n\n    this.handleShortcutPaneShowToggle = () => {\n      this.setState({\n        paneHidden: !this.state.paneHidden\n      });\n    };\n\n    this.handleKeyEvent = (key, e) => {\n      e.preventDefault();\n\n      switch (key) {\n        case \"r\":\n          this.handleReload();\n          break;\n\n        case \"left\":\n          this.handleBackward();\n          break;\n\n        case \"right\":\n          this.handleForward();\n          break;\n\n        case \"space\":\n          this.handlePlayPause();\n          break;\n\n        case \",\":\n          this.handleSettings();\n          break;\n\n        default:\n          break;\n      }\n    };\n\n    this.keyboardCodeMap = {\n      KeyR: \"r\",\n      ArrowLeft: \"left\",\n      ArrowRight: \"right\",\n      Space: \"space\",\n      Settings: \",\"\n    };\n  }\n\n  componentDidMount() {\n    window.addEventListener(\"message\", this.handleParentKeyboardEvent);\n  }\n\n  componentWillUnmount() {\n    window.removeEventListener(\"message\", this.handleParentKeyboardEvent);\n  }\n\n  render() {\n    return this.renderControls();\n  }\n\n  renderScrubbing() {\n    const value = this.props.hasAllFrames ? this.props.currentFrame.turn : 0;\n    const max = this.props.hasAllFrames ? this.props.maxTurn : 0;\n    return this.props.showFrameScrubber && /*#__PURE__*/_jsxDEV(ButtonWrapper, {\n      children: /*#__PURE__*/_jsxDEV(Scrubber, {\n        type: \"range\",\n        min: \"0\",\n        max: max,\n        value: value,\n        onMouseDown: this.handleScrubMouseDown,\n        onChange: this.handleScrubbing,\n        disabled: !this.props.hasAllFrames\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 191,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 190,\n      columnNumber: 9\n    }, this);\n  }\n\n  renderControls() {\n    const {\n      currentFrame,\n      hideControls,\n      paused,\n      theme,\n      persistAvailable\n    } = this.props;\n    const settingsInfo = persistAvailable ? \"Configure playback settings\" : \"Enable localStorage to configure playback settings\";\n    return /*#__PURE__*/_jsxDEV(MediaControlsWrapper, {\n      hide: hideControls,\n      children: [this.renderScrubbing(), /*#__PURE__*/_jsxDEV(ButtonWrapper, {\n        children: [/*#__PURE__*/_jsxDEV(Button, {\n          onClick: this.handleBackward,\n          disabled: currentFrame.turn === 0 || !paused,\n          theme: theme,\n          children: /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"material-icons icon-image-preview\",\n            children: \"skip_previous\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 227,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 222,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Button, {\n          onClick: this.handlePlayPause,\n          theme: theme,\n          children: /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"material-icons icon-image-preview\",\n            children: paused ? \"play_arrow\" : \"pause\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 232,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 231,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Button, {\n          onClick: this.handleForward,\n          disabled: !paused,\n          theme: theme,\n          children: /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"material-icons icon-image-preview\",\n            children: \"skip_next\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 237,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 236,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Button, {\n          onClick: this.handleReload,\n          disabled: currentFrame.turn === 0 || !paused,\n          theme: theme,\n          children: /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"material-icons icon-image-preview\",\n            children: \"refresh\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 244,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 239,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Button, {\n          onClick: this.handleSettings,\n          disabled: !persistAvailable,\n          theme: theme,\n          children: /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"material-icons icon-image-preview\",\n            title: settingsInfo,\n            children: \"settings\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 251,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 246,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(KeyboardEventHandler, {\n          handleKeys: Object.values(this.keyboardCodeMap),\n          onKeyEvent: this.handleKeyEvent\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 258,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(KeyboardShortcutsWrapper, {\n          children: [/*#__PURE__*/_jsxDEV(Button, {\n            onClick: this.handleShortcutPaneShowToggle,\n            theme: theme,\n            children: /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"material-icons icon-image-preview\",\n              children: \"help\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 264,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 263,\n            columnNumber: 13\n          }, this), !this.state.paneHidden && /*#__PURE__*/_jsxDEV(ShortcutsPane, {\n            children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n              children: \"Keyboard shortcuts\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 268,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"ul\", {\n              children: [/*#__PURE__*/_jsxDEV(\"li\", {\n                children: \"Reload = r\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 270,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"li\", {\n                children: \"Play/Pause = space\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 271,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"li\", {\n                children: \"Backward = left arrow\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 272,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"li\", {\n                children: \"Forward = right arrow\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 273,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"li\", {\n                children: \"Settings = comma\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 274,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 269,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 267,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 262,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 221,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 219,\n      columnNumber: 7\n    }, this);\n  }\n\n}\n\nexport default _c5 = withRouter(MediaControls);\n\nvar _c, _c2, _c3, _c4, _c5;\n\n$RefreshReg$(_c, \"MediaControlsWrapper\");\n$RefreshReg$(_c2, \"ShortcutsPane\");\n$RefreshReg$(_c3, \"Button\");\n$RefreshReg$(_c4, \"Scrubber\");\n$RefreshReg$(_c5, \"%default%\");","map":{"version":3,"sources":["/Users/yabu/board/src/components/mediaControls.jsx"],"names":["React","styled","KeyboardEventHandler","withRouter","themes","breakpoints","MediaControlsWrapper","hide","KeyboardShortcutsWrapper","position","ShortcutsPane","md","ButtonWrapper","display","justifyContent","width","Button","theme","dark","sm","Scrubber","MediaControls","Component","constructor","props","state","paneHidden","handleParentKeyboardEvent","e","code","data","handleKeyEvent","keyboardCodeMap","handleReload","reloadGame","handlePlayPause","toggleGamePause","handleBackward","stepBackwardFrame","handleForward","stepForwardFrame","handleScrubMouseDown","pauseGame","handleScrubbing","event","stepToTurn","parseInt","target","value","handleSettings","persistAvailable","history","push","handleShortcutPaneShowToggle","setState","key","preventDefault","KeyR","ArrowLeft","ArrowRight","Space","Settings","componentDidMount","window","addEventListener","componentWillUnmount","removeEventListener","render","renderControls","renderScrubbing","hasAllFrames","currentFrame","turn","max","maxTurn","showFrameScrubber","hideControls","paused","settingsInfo","Object","values"],"mappings":"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","sourcesContent":["import React from \"react\";\nimport styled from \"@emotion/styled\";\nimport KeyboardEventHandler from \"react-keyboard-event-handler\";\nimport { withRouter } from \"react-router\";\nimport { themes, breakpoints } from \"../theme\";\n\nconst MediaControlsWrapper = styled(\"div\")`\n  display: ${({ hide }) => (hide ? \"none\" : \"block\")};\n  margin-top: 1rem;\n  width: 100%;\n`;\n\nconst KeyboardShortcutsWrapper = styled(\"div\")({\n  position: \"relative\"\n});\n\nconst ShortcutsPane = styled(\"div\")`\n  position: absolute;\n  bottom: 2.5rem;\n  right: 2.5rem;\n  width: 20rem;\n  padding: 1rem;\n  border: solid 1px #999;\n  background: #fff;\n\n  @media (min-width: ${breakpoints.md}) {\n    left: 2.5rem;\n    right: 0;\n  }\n\n  h4 {\n    margin-top: 0;\n    margin-bottom: 1rem;\n  }\n\n  ul {\n    list-style-type: none;\n    margin: 0;\n    padding: 0;\n  }\n`;\n\nconst ButtonWrapper = styled(\"div\")({\n  display: \"flex\",\n  justifyContent: \"center\",\n  width: \"100%\"\n});\n\nconst Button = styled(\"button\")`\n  display: inline-block;\n  min-width: 3rem;\n  text-align: center;\n  background: transparent;\n  color: ${({ theme }) => (theme === themes.dark ? \"#eee\" : \"#333\")};\n  font-size: 1.4rem;\n  border: none;\n  text-decoration: none;\n  cursor: pointer;\n  transition: background 250ms ease-in-out, transform 150ms ease;\n  -webkit-appearance: none;\n  -moz-appearance: none;\n\n  &:hover {\n    cursor: pointer;\n  }\n\n  &:focus {\n    outline: none;\n  }\n\n  &:disabled {\n    color: #ccc;\n    cursor: not-allowed;\n  }\n\n  @media (max-width: ${breakpoints.sm}) {\n    padding: 2rem 2rem;\n  }\n`;\n\nconst Scrubber = styled(\"input\")`\n  width: 100%;\n  max-width: 60rem;\n\n  &:disabled,\n  &:disabled:hover {\n    opacity: 0.2;\n    cursor: not-allowed;\n  }\n`;\n\nclass MediaControls extends React.Component {\n  state = {\n    paneHidden: true\n  };\n\n  constructor(props) {\n    super(props);\n    this.keyboardCodeMap = {\n      KeyR: \"r\",\n      ArrowLeft: \"left\",\n      ArrowRight: \"right\",\n      Space: \"space\",\n      Settings: \",\"\n    };\n  }\n\n  componentDidMount() {\n    window.addEventListener(\"message\", this.handleParentKeyboardEvent);\n  }\n\n  componentWillUnmount() {\n    window.removeEventListener(\"message\", this.handleParentKeyboardEvent);\n  }\n\n  render() {\n    return this.renderControls();\n  }\n\n  handleParentKeyboardEvent = e => {\n    const { code } = e.data;\n    this.handleKeyEvent(this.keyboardCodeMap[code], e);\n  };\n\n  handleReload = () => {\n    this.props.reloadGame();\n  };\n\n  handlePlayPause = () => {\n    this.props.toggleGamePause();\n  };\n\n  handleBackward = () => {\n    this.props.stepBackwardFrame();\n  };\n\n  handleForward = () => {\n    this.props.stepForwardFrame();\n  };\n\n  handleScrubMouseDown = () => {\n    this.props.pauseGame();\n  };\n\n  handleScrubbing = event => {\n    this.props.stepToTurn(parseInt(event.target.value));\n  };\n\n  handleSettings = () => {\n    if (this.props.persistAvailable) {\n      this.props.history.push(\"/settings\");\n    }\n  };\n\n  handleShortcutPaneShowToggle = () => {\n    this.setState({\n      paneHidden: !this.state.paneHidden\n    });\n  };\n\n  handleKeyEvent = (key, e) => {\n    e.preventDefault();\n    switch (key) {\n      case \"r\":\n        this.handleReload();\n        break;\n      case \"left\":\n        this.handleBackward();\n        break;\n      case \"right\":\n        this.handleForward();\n        break;\n      case \"space\":\n        this.handlePlayPause();\n        break;\n      case \",\":\n        this.handleSettings();\n        break;\n      default:\n        break;\n    }\n  };\n\n  renderScrubbing() {\n    const value = this.props.hasAllFrames ? this.props.currentFrame.turn : 0;\n    const max = this.props.hasAllFrames ? this.props.maxTurn : 0;\n\n    return (\n      this.props.showFrameScrubber && (\n        <ButtonWrapper>\n          <Scrubber\n            type=\"range\"\n            min=\"0\"\n            max={max}\n            value={value}\n            onMouseDown={this.handleScrubMouseDown}\n            onChange={this.handleScrubbing}\n            disabled={!this.props.hasAllFrames}\n          />\n        </ButtonWrapper>\n      )\n    );\n  }\n\n  renderControls() {\n    const {\n      currentFrame,\n      hideControls,\n      paused,\n      theme,\n      persistAvailable\n    } = this.props;\n\n    const settingsInfo = persistAvailable\n      ? \"Configure playback settings\"\n      : \"Enable localStorage to configure playback settings\";\n\n    return (\n      <MediaControlsWrapper hide={hideControls}>\n        {this.renderScrubbing()}\n        <ButtonWrapper>\n          <Button\n            onClick={this.handleBackward}\n            disabled={currentFrame.turn === 0 || !paused}\n            theme={theme}\n          >\n            <span className=\"material-icons icon-image-preview\">\n              skip_previous\n            </span>\n          </Button>\n          <Button onClick={this.handlePlayPause} theme={theme}>\n            <span className=\"material-icons icon-image-preview\">\n              {paused ? \"play_arrow\" : \"pause\"}\n            </span>\n          </Button>\n          <Button onClick={this.handleForward} disabled={!paused} theme={theme}>\n            <span className=\"material-icons icon-image-preview\">skip_next</span>\n          </Button>\n          <Button\n            onClick={this.handleReload}\n            disabled={currentFrame.turn === 0 || !paused}\n            theme={theme}\n          >\n            <span className=\"material-icons icon-image-preview\">refresh</span>\n          </Button>\n          <Button\n            onClick={this.handleSettings}\n            disabled={!persistAvailable}\n            theme={theme}\n          >\n            <span\n              className=\"material-icons icon-image-preview\"\n              title={settingsInfo}\n            >\n              settings\n            </span>\n          </Button>\n          <KeyboardEventHandler\n            handleKeys={Object.values(this.keyboardCodeMap)}\n            onKeyEvent={this.handleKeyEvent}\n          />\n          <KeyboardShortcutsWrapper>\n            <Button onClick={this.handleShortcutPaneShowToggle} theme={theme}>\n              <span className=\"material-icons icon-image-preview\">help</span>\n            </Button>\n            {!this.state.paneHidden && (\n              <ShortcutsPane>\n                <h4>Keyboard shortcuts</h4>\n                <ul>\n                  <li>Reload = r</li>\n                  <li>Play/Pause = space</li>\n                  <li>Backward = left arrow</li>\n                  <li>Forward = right arrow</li>\n                  <li>Settings = comma</li>\n                </ul>\n              </ShortcutsPane>\n            )}\n          </KeyboardShortcutsWrapper>\n        </ButtonWrapper>\n      </MediaControlsWrapper>\n    );\n  }\n}\n\nexport default withRouter(MediaControls);\n"]},"metadata":{},"sourceType":"module"}