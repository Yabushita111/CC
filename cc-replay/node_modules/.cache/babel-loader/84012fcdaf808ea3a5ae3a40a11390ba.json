{"ast":null,"code":"import _toConsumableArray from\"/Users/yabu/CC/board/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _objectSpread from\"/Users/yabu/CC/board/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import{formatFrame,sanitizeFrame}from\"../utils/game-state\";import*as types from\"../actions/action-types\";import{themes}from\"../theme\";var initialState={options:null,grid:[],frames:[],endEvent:{},paused:true,gameNotFound:false,highlightedSnake:null,theme:themes.light};var reducers=function reducers(){var state=arguments.length>0&&arguments[0]!==undefined?arguments[0]:initialState;var action=arguments.length>1?arguments[1]:undefined;switch(action.type){case types.SET_THEME:return _objectSpread(_objectSpread({},state),{},{theme:action.theme});case types.SET_GAME_OPTIONS:action.gameOptions.turn=parseInt(action.gameOptions.turn)||0;action.gameOptions.loop=action.gameOptions.loop&&action.gameOptions.loop===\"true\";return _objectSpread(_objectSpread({},state),{},{gameOptions:action.gameOptions});case types.GAME_NOT_FOUND:return _objectSpread(_objectSpread({},state),{},{gameNotFound:true});case types.PAUSE_GAME:return _objectSpread(_objectSpread({},state),{},{paused:true});case types.GAME_OVER:windowPostMessage({action:action.type,endEvent:action.endEvent});return _objectSpread(_objectSpread({},state),{},{paused:true});case types.RESUME_GAME:return _objectSpread(_objectSpread({},state),{},{paused:false});case types.SET_CURRENT_FRAME:windowPostMessage({action:action.type,frame:sanitizeFrame(action.frame)});return _objectSpread(_objectSpread({},state),{},{currentFrame:action.frame});case types.RECEIVE_FRAME:var frame=formatFrame(action.frame);return _objectSpread(_objectSpread({},state),{},{ruleset:action.game.Game.Ruleset,grid:{height:action.game.Game.Height,width:action.game.Game.Width},frames:[].concat(_toConsumableArray(state.frames),[frame])// Be smart: this consumes A LOT of memory...\n});case types.RECEIVE_EVENT_END:return _objectSpread(_objectSpread({},state),{},{endEvent:action.endEvent,frames:[].concat(_toConsumableArray(state.frames),[action.frame])});case types.REQUEST_FRAMES:return _objectSpread({},state);case types.FETCH_FRAMES:return _objectSpread({},state);case types.HIGHLIGHT_SNAKE:windowPostMessage({action:action.type,id:action.snakeId,name:action.snakeId?state.currentFrame.snakes.find(function(s){return s._id===action.snakeId;}).name:null});return _objectSpread(_objectSpread({},state),{},{highlightedSnake:action.snakeId});case types.TOGGLE_SETTINGS_VIEW:windowPostMessage({action:action.type,value:action.showHide});return _objectSpread({},state);case types.THEME_CHANGED:windowPostMessage({action:action.type,value:action.theme});return _objectSpread({},state);default:return _objectSpread({},state);}};function windowPostMessage(data){if(!window.parent){return;}try{window.parent.postMessage(data,\"*\");}catch(e){console.error(e);}}export default reducers;","map":{"version":3,"sources":["/Users/yabu/CC/board/src/reducers/index.js"],"names":["formatFrame","sanitizeFrame","types","themes","initialState","options","grid","frames","endEvent","paused","gameNotFound","highlightedSnake","theme","light","reducers","state","action","type","SET_THEME","SET_GAME_OPTIONS","gameOptions","turn","parseInt","loop","GAME_NOT_FOUND","PAUSE_GAME","GAME_OVER","windowPostMessage","RESUME_GAME","SET_CURRENT_FRAME","frame","currentFrame","RECEIVE_FRAME","ruleset","game","Game","Ruleset","height","Height","width","Width","RECEIVE_EVENT_END","REQUEST_FRAMES","FETCH_FRAMES","HIGHLIGHT_SNAKE","id","snakeId","name","snakes","find","s","_id","TOGGLE_SETTINGS_VIEW","value","showHide","THEME_CHANGED","data","window","parent","postMessage","e","console","error"],"mappings":"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","sourcesContent":["import { formatFrame, sanitizeFrame } from \"../utils/game-state\";\nimport * as types from \"../actions/action-types\";\nimport { themes } from \"../theme\";\n\nconst initialState = {\n  options: null,\n  grid: [],\n  frames: [],\n  endEvent: {},\n  paused: true,\n  gameNotFound: false,\n  highlightedSnake: null,\n  theme: themes.light\n};\n\nconst reducers = (state = initialState, action) => {\n  switch (action.type) {\n    case types.SET_THEME:\n      return { ...state, theme: action.theme };\n    case types.SET_GAME_OPTIONS:\n      action.gameOptions.turn = parseInt(action.gameOptions.turn) || 0;\n      action.gameOptions.loop =\n        action.gameOptions.loop && action.gameOptions.loop === \"true\";\n      return { ...state, gameOptions: action.gameOptions };\n    case types.GAME_NOT_FOUND:\n      return { ...state, gameNotFound: true };\n    case types.PAUSE_GAME:\n      return { ...state, paused: true };\n    case types.GAME_OVER:\n      windowPostMessage({\n        action: action.type,\n        endEvent: action.endEvent\n      });\n      return { ...state, paused: true };\n    case types.RESUME_GAME:\n      return { ...state, paused: false };\n    case types.SET_CURRENT_FRAME:\n      windowPostMessage({\n        action: action.type,\n        frame: sanitizeFrame(action.frame)\n      });\n      return { ...state, currentFrame: action.frame };\n    case types.RECEIVE_FRAME:\n      const frame = formatFrame(action.frame);\n      return {\n        ...state,\n        ruleset: action.game.Game.Ruleset,\n        grid: {\n          height: action.game.Game.Height,\n          width: action.game.Game.Width\n        },\n        frames: [...state.frames, frame] // Be smart: this consumes A LOT of memory...\n      };\n    case types.RECEIVE_EVENT_END:\n      return {\n        ...state,\n        endEvent: action.endEvent,\n        frames: [...state.frames, action.frame]\n      };\n    case types.REQUEST_FRAMES:\n      return { ...state };\n    case types.FETCH_FRAMES:\n      return { ...state };\n    case types.HIGHLIGHT_SNAKE:\n      windowPostMessage({\n        action: action.type,\n        id: action.snakeId,\n        name: action.snakeId\n          ? state.currentFrame.snakes.find(s => s._id === action.snakeId).name\n          : null\n      });\n      return { ...state, highlightedSnake: action.snakeId };\n    case types.TOGGLE_SETTINGS_VIEW:\n      windowPostMessage({\n        action: action.type,\n        value: action.showHide\n      });\n      return { ...state };\n    case types.THEME_CHANGED:\n      windowPostMessage({\n        action: action.type,\n        value: action.theme\n      });\n      return { ...state };\n    default:\n      return { ...state };\n  }\n};\n\nfunction windowPostMessage(data) {\n  if (!window.parent) {\n    return;\n  }\n  try {\n    window.parent.postMessage(data, \"*\");\n  } catch (e) {\n    console.error(e);\n  }\n}\n\nexport default reducers;\n"]},"metadata":{},"sourceType":"module"}